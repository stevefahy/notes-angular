import{a as Y,b as Z,d as oo,h as to,i as S}from"./chunk-TTBA2OHA.js";import"./chunk-GBKQVC3J.js";import"./chunk-Y7BJSR4Q.js";import{a as eo,b as no,c as io}from"./chunk-5NQTDSXH.js";import{b as K}from"./chunk-SFGOAYRY.js";import{a as Q,b as W,d as X}from"./chunk-TLQKHOM2.js";import{a as w}from"./chunk-B5RC25IS.js";import{D as P,l as U,oa as V,q as O,qa as J,ra as q,sa as D,ta as G,ua as y,wa as L}from"./chunk-7OUEVMB7.js";import{j as h,o as _}from"./chunk-7QZQAXAI.js";import{Da as E,Eb as F,Fb as s,Gb as d,Hb as I,Ib as H,Jb as c,Kb as r,Lb as a,Mb as m,Rb as R,Tb as j,V as N,Vb as g,ab as i,ea as f,ec as C,fc as z,gc as B,h as u,ic as v,l as M,la as $,lc as x,ma as T,pb as k,xa as b}from"./chunk-5HUWBQGC.js";var po=q,ro=(t,l,o)=>u(null,null,function*(){let n;try{let p={notebookName:l,notebookCover:o};if(n=yield fetch(G.APP_API_ENDPOINT+"api/data/addnotebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(p)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(p){return{error:D(p)}}let e;try{if(e=yield n.json(),e===null)return{error:`${po.NOTEBOOK_CREATE_ERROR}`}}catch(p){return{error:D(p)}}return e.error?{error:e.error}:e});var go=()=>({height:"50px"}),ko=()=>({height:"20px","margin-bottom":"0px","margin-top":"20px"}),_o=()=>({height:"10px"});function uo(t,l){t&1&&(r(0,"div"),m(1,"ngx-skeleton-loader",5),a()),t&2&&(i(),c("theme",x(1,go)))}function fo(t,l){t&1&&(r(0,"div"),m(1,"ngx-skeleton-loader",5)(2,"ngx-skeleton-loader",5),a()),t&2&&(i(),c("theme",x(2,ko)),i(),c("theme",x(3,_o)))}function Co(t,l){if(t&1&&(r(0,"div"),C(1),a(),r(2,"div",6)(3,"div"),C(4),a()()),t&2){let o=g();i(),z(o.notebook_item$().notebook_name),i(3),B(" ",o.dateFormat(o.notebook_item$().updatedAt)," ")}}var so=(()=>{class t{constructor(){this.notebook_item$=b(null),this.notebookLoaded$=b(!1),this.dateFormat=S}set notebookLoaded(o){this.notebookLoaded$.set(o)}set notebook_item(o){o!==null&&this.notebook_item$.set(o)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=k({type:t,selectors:[["NotebookListHtml"]],inputs:{notebookLoaded:"notebookLoaded",notebook_item:"notebook_item"},decls:9,vars:5,consts:[["ngClass","notebooks_list_bg"],["ngClass","cardcontent"],["ngClass","notebooks_list_outer"],[3,"ngClass"],["ngClass","notebooks_list_right"],["count","1","appearance","line",3,"theme"],["ngClass","date_format"]],template:function(n,e){n&1&&(r(0,"li",0)(1,"mat-card")(2,"mat-card-content",1)(3,"div",2)(4,"div",3),s(5,uo,2,2,"div"),a(),r(6,"div",4),s(7,fo,3,4,"div"),s(8,Co,5,2),a()()()()()),n&2&&(i(4),c("ngClass",v("notebooks_list_left ",e.notebookLoaded$()?"tab_"+e.notebook_item$().notebook_cover:"")),i(),d(e.notebookLoaded$()?-1:5),i(2),d(e.notebookLoaded$()?-1:7),i(),d(e.notebookLoaded$()?8:-1))},dependencies:[_,h,O,X,Q,W,io,no],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return t})();function ho(t,l){t&1&&m(0,"NotebookListHtml",0),t&2&&c("notebook_item",null)("notebookLoaded",!1)}function Mo(t,l){if(t&1&&(r(0,"a",1),m(1,"NotebookListHtml",0),a()),t&2){let o=g();c("routerLink",v("/notebook/",o.notebook_item._id)),i(),c("notebook_item",o.notebook_item)("notebookLoaded",o.notebookLoaded())}}var lo=(()=>{class t{constructor(){this.notebookLoaded=b(!1),this.dateFormat=S,this.hideSkeleton=()=>{this.loadedTimer=setTimeout(()=>{this.notebookLoaded.set(!0),clearTimeout(this.loadedTimer)},300)}}ngOnChanges(o){o.notebook_item&&this.hideSkeleton()}ngOnInit(){}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=k({type:t,selectors:[["NotebookListItem"]],inputs:{notebook_item:"notebook_item"},features:[E],decls:2,vars:2,consts:[[3,"notebook_item","notebookLoaded"],[3,"routerLink"]],template:function(n,e){n&1&&(s(0,ho,1,2,"NotebookListHtml",0),s(1,Mo,2,4,"a",1)),n&2&&(d(e.notebookLoaded()?-1:0),i(),d(e.notebookLoaded()?1:-1))},dependencies:[_,O,U,so],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return t})();function No(t,l){t&1&&(r(0,"div"),m(1,"LoadingScreen"),a())}function vo(t,l){if(t&1&&m(0,"NotebookListItem",2),t&2){let o=l.$implicit;c("notebook_item",o)}}function xo(t,l){if(t&1&&(r(0,"div")(1,"ul",1),I(2,vo,1,1,"NotebookListItem",2,F().trackByuserNotebooks,!0),a()()),t&2){let o=g();i(2),H(o.userNotebooks())}}function Oo(t,l){if(t&1){let o=R();r(0,"button",3),j("click",function(){$(o);let e=g();return T(e.addNotebookFormHandler())}),r(1,"span",4)(2,"span",5),C(3," add_circle "),a(),C(4," Add Notebook "),a()()}}var co=(()=>{class t{constructor(){this.enableAddNotebook=b(!1),this.userNotebooks=b([]),this.isLoaded=b(!1),this.authService=f(L),this.store=f(P),this.dialog=f(oo),this.onDestroy$=new M,this.trackByuserNotebooks=(o,n)=>n?n._id:void 0,this.updateContext=o=>{this.loading=o.loading,this.token=o.token},this.initUserNotebooks=o=>{if(o&&o.success&&o.notebooks){let n=o.notebooks;this.userNotebooks.set(n),this.isLoaded.set(!0)}o&&o.error&&this.showNotification(o.error)},this.showNotification=o=>{this.store.dispatch(y.showNotification({notification:{n_status:"error",title:"Error!",message:o}}))},this.addNotebookFormHandler=()=>{this.openAddNotebookFormDialog()},this.cancelHandler=()=>{this.dialogRef.close()},this.addNotebookHandler=(o,n)=>u(this,null,function*(){if(this.token)try{let e=yield ro(this.token,o,n);if(e.error){this.showNotification(`${e.error}`);return}e.success&&this.userNotebooks.update(p=>[{_id:e.notebook._id,notebook_name:e.notebook.notebook_name,notebook_cover:e.notebook.notebook_cover,updatedAt:e.notebook.updatedAt,createdAt:e.notebook.createdAt},...p])}catch(e){this.showNotification(`${e}`);return}})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnInit(){this.authService.authContext$.pipe(N(this.onDestroy$)).subscribe(o=>{this.updateContext(o),this.initUserNotebooks(this.notebooks)})}openAddNotebookFormDialog(){let o=new Z;o.disableClose=!0,o.autoFocus=!0,o.data={method:"create",addNotebook:this.addNotebookHandler,onCancel:this.cancelHandler},this.dialogRef=this.dialog.open(to,o)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=k({type:t,selectors:[["NotebooksList"]],inputs:{notebooks:"notebooks"},decls:4,vars:3,consts:[["mat-button","","color","secondary","aria-label","Add notebook button","ngClass","contained medium breadcrumb_edit_fab button_fab"],["ngClass","notebooks_list"],[3,"notebook_item"],["mat-button","","color","secondary","aria-label","Add notebook button","ngClass","contained medium breadcrumb_edit_fab button_fab",3,"click"],["ngClass","icon_text"],["ngClass","material-symbols-outlined button_icon white"]],template:function(n,e){n&1&&(s(0,No,2,0,"div"),s(1,xo,4,0,"div"),r(2,"Footer"),s(3,Oo,5,0,"button",0),a()),n&2&&(d(e.isLoaded()?-1:0),i(),d(e.userNotebooks()?1:-1),i(2),d(e.userNotebooks()?3:-1))},dependencies:[_,h,J,V,K,w,eo,lo],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return t})();function Po(t,l){t&1&&(r(0,"div"),m(1,"LoadingScreen"),a())}function yo(t,l){if(t&1&&(r(0,"div"),m(1,"NotebooksList",1),a()),t&2){let o=g();i(),c("notebooks",o.userNotebooks())}}var bo=(()=>{class t{constructor(){this.notebooksLoaded=b(!1),this.userNotebooks=b({success:!1,notebooks:[]}),this.authService=f(L),this.store=f(P),this.onDestroy$=new M,this.updateContext=o=>{this.loading=o.loading,this.token=o.token},this.showNotification=o=>{this.store.dispatch(y.showNotification({notification:{n_status:"error",title:"Error!",message:o}}))},this.loadNotebooks=()=>u(this,null,function*(){if(!this.notebooksLoaded()&&this.token)try{let o=yield Y(this.token);if(o.error){this.showNotification(`${o.error}`);return}o.success&&(this.userNotebooks.set(o),this.filterNotebooks())}catch(o){this.showNotification(`${o}`);return}}),this.filterNotebooks=()=>u(this,null,function*(){let o=this.userNotebooks().notebooks,n=this.userNotebooks().error;o&&o.length>0&&(o.map(e=>(e.updatedAt==="No date"&&(e.updatedAt="December 17, 1995 03:24:00"),e)),o.sort((e,p)=>e.updatedAt!==void 0&&p.updatedAt!==void 0?new Date(e.updatedAt)>new Date(p.updatedAt)?1:-1:e.updatedAt!==void 0?1:-1).reverse(),this.userNotebooks.set({success:!0,notebooks:o}),this.notebooksLoaded.set(!0)),n&&this.showNotification(n)})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnInit(){this.authService.authContext$.pipe(N(this.onDestroy$)).subscribe(o=>{this.updateContext(o),this.loadNotebooks()})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=k({type:t,selectors:[["Notebooks"]],decls:3,vars:2,consts:[["ngClass","page_scrollable_header_breadcrumb_footer_list"],[3,"notebooks"]],template:function(n,e){n&1&&(s(0,Po,2,0,"div"),r(1,"div",0),s(2,yo,2,1,"div"),a()),n&2&&(d(e.notebooksLoaded()?-1:0),i(2),d(e.notebooksLoaded()&&e.userNotebooks().notebooks?2:-1))},dependencies:[_,h,w,co],encapsulation:2})}}return t})();var Dt=[{path:"",component:bo}];export{Dt as notebooksRoutes};
