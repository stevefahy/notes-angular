import{a as so,b as $}from"./chunk-EM37P3NJ.js";import{c as lo}from"./chunk-64SVY3WO.js";import{a as A,e as io,f as ro,h as ao}from"./chunk-322FMVNF.js";import{$ as eo,B as S,C as D,D as W,E as X,H as Y,O as Z,Q as oo,_ as to,aa as no,m as q,n as I,p as T,q as G,r as Q,v as w}from"./chunk-4KA7YYCZ.js";import{$b as u,Ba as g,Ga as H,Kb as j,Lb as l,Mb as c,Nb as R,Ob as z,Pb as p,Qb as a,Rb as s,Sb as k,Xb as B,Y as x,Zb as U,Zc as N,cd as K,db as r,ea as O,j as _,mb as C,n as M,nc as h,oc as V,pa as F,pc as J,qa as E,rc as P,sb as f,tb as y,uc as L}from"./chunk-AS4DOYW2.js";var _o=G,co=(o,m,t)=>_(null,null,function*(){let n;try{let i={notebookName:m,notebookCover:t};if(n=yield fetch(Q.APP_API_ENDPOINT+"api/data/addnotebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(i)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(i){return{error:T(i)}}let e;try{if(e=yield n.json(),e===null)return{error:`${_o.NOTEBOOK_CREATE_ERROR}`}}catch(i){return{error:T(i)}}return e.error?{error:e.error}:e});var Co=()=>({height:"50px"}),ho=()=>({height:"20px","margin-bottom":"0px","margin-top":"20px"}),No=()=>({height:"10px"});function vo(o,m){o&1&&(a(0,"div"),k(1,"ngx-skeleton-loader",5),s()),o&2&&(r(),p("theme",L(1,Co)))}function Mo(o,m){o&1&&(a(0,"div"),k(1,"ngx-skeleton-loader",5)(2,"ngx-skeleton-loader",5),s()),o&2&&(r(),p("theme",L(2,ho)),r(),p("theme",L(3,No)))}function xo(o,m){if(o&1&&(a(0,"div"),h(1),s(),a(2,"div",6)(3,"div"),h(4),s()()),o&2){let t=u();r(),V(t.notebook_item$().notebook_name),r(3),J(" ",t.dateFormat(t.notebook_item$().updatedAt)," ")}}var bo=(()=>{class o{constructor(){this.notebook_item$=g(null),this.notebookLoaded$=g(!1),this.dateFormat=$}set notebookLoaded(t){this.notebookLoaded$.set(t)}set notebook_item(t){t!==null&&this.notebook_item$.set(t)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=f({type:o,selectors:[["NotebookListHtml"]],inputs:{notebookLoaded:"notebookLoaded",notebook_item:"notebook_item"},standalone:!1,decls:9,vars:5,consts:[["ngClass","notebooks_list_bg"],["ngClass","cardcontent"],["ngClass","notebooks_list_outer"],[3,"ngClass"],["ngClass","notebooks_list_right"],["count","1","appearance","line",3,"theme"],["ngClass","date_format"]],template:function(n,e){n&1&&(a(0,"li",0)(1,"mat-card")(2,"mat-card-content",1)(3,"div",2)(4,"div",3),l(5,vo,2,2,"div"),s(),a(6,"div",4),l(7,Mo,3,4,"div"),l(8,xo,5,2),s()()()()()),n&2&&(r(4),p("ngClass",P("notebooks_list_left ",e.notebookLoaded$()?"tab_"+e.notebook_item$().notebook_cover:"")),r(),c(e.notebookLoaded$()?-1:5),r(2),c(e.notebookLoaded$()?-1:7),r(),c(e.notebookLoaded$()?8:-1))},dependencies:[N,W,X,eo],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return o})();function yo(o,m){o&1&&k(0,"NotebookListHtml",0),o&2&&p("notebook_item",null)("notebookLoaded",!1)}function Po(o,m){if(o&1&&(a(0,"a",1),k(1,"NotebookListHtml",0),s()),o&2){let t=u();p("routerLink",P("/notebook/",t.notebook_item._id)),r(),p("notebook_item",t.notebook_item)("notebookLoaded",t.notebookLoaded())}}var po=(()=>{class o{constructor(){this.notebookLoaded=g(!1),this.dateFormat=$,this.hideSkeleton=()=>{this.loadedTimer=setTimeout(()=>{this.notebookLoaded.set(!0),clearTimeout(this.loadedTimer)},300)}}ngOnChanges(t){t.notebook_item&&this.hideSkeleton()}ngOnInit(){}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=f({type:o,selectors:[["NotebookListItem"]],inputs:{notebook_item:"notebook_item"},standalone:!1,features:[H],decls:2,vars:2,consts:[[3,"notebook_item","notebookLoaded"],[3,"routerLink"]],template:function(n,e){n&1&&(l(0,yo,1,2,"NotebookListHtml",0),l(1,Po,2,4,"a",1)),n&2&&(c(e.notebookLoaded()?-1:0),r(),c(e.notebookLoaded()?1:-1))},dependencies:[q,bo],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return o})();function Ao(o,m){o&1&&(a(0,"div"),k(1,"LoadingScreen"),s())}function $o(o,m){if(o&1&&k(0,"NotebookListItem",2),o&2){let t=m.$implicit;p("notebook_item",t)}}function Io(o,m){if(o&1&&(a(0,"div")(1,"ul",1),R(2,$o,1,1,"NotebookListItem",2,j().trackByuserNotebooks,!0),s()()),o&2){let t=u();r(2),z(t.userNotebooks())}}function To(o,m){if(o&1){let t=B();a(0,"button",3),U("click",function(){F(t);let e=u();return E(e.addNotebookFormHandler())}),a(1,"span",4)(2,"span",5),h(3," add_circle "),s(),h(4," Add Notebook "),s()()}}var go=(()=>{class o{constructor(t,n,e){this.authService=t,this.store=n,this.dialog=e,this.enableAddNotebook=g(!1),this.userNotebooks=g([]),this.isLoaded=g(!1),this.onDestroy$=new M,this.trackByuserNotebooks=(i,d)=>d?d._id:void 0,this.updateContext=i=>{this.loading=i.loading,this.token=i.token},this.initUserNotebooks=i=>{if(i&&i.success&&i.notebooks){let d=i.notebooks;this.userNotebooks.set(d),this.isLoaded.set(!0)}i&&i.error&&this.showNotification(i.error)},this.showNotification=i=>{this.store.dispatch(S.showNotification({notification:{n_status:"error",title:"Error!",message:i}}))},this.addNotebookFormHandler=()=>{this.openAddNotebookFormDialog()},this.cancelHandler=()=>{this.dialogRef.close()},this.addNotebookHandler=(i,d)=>_(this,null,function*(){if(this.token)try{let b=yield co(this.token,i,d);if(b.error){this.showNotification(`${b.error}`);return}b.success&&this.userNotebooks.update(fo=>[{_id:b.notebook._id,notebook_name:b.notebook.notebook_name,notebook_cover:b.notebook.notebook_cover,updatedAt:b.notebook.updatedAt,createdAt:b.notebook.createdAt},...fo])}catch(b){this.showNotification(`${b}`);return}})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnInit(){this.authService.authContext$.pipe(x(this.onDestroy$)).subscribe(t=>{this.updateContext(t),this.initUserNotebooks(this.notebooks)})}openAddNotebookFormDialog(){let t=new Z;t.disableClose=!0,t.autoFocus=!0,t.data={method:"create",addNotebook:this.addNotebookHandler,onCancel:this.cancelHandler},this.dialogRef=this.dialog.open(ro,t)}static{this.\u0275fac=function(n){return new(n||o)(C(D),C(w),C(oo))}}static{this.\u0275cmp=f({type:o,selectors:[["NotebooksList"]],inputs:{notebooks:"notebooks"},standalone:!1,decls:4,vars:3,consts:[["mat-button","","color","secondary","aria-label","Add notebook button","ngClass","contained medium breadcrumb_edit_fab button_fab"],["ngClass","notebooks_list"],[3,"notebook_item"],["mat-button","","color","secondary","aria-label","Add notebook button","ngClass","contained medium breadcrumb_edit_fab button_fab",3,"click"],["ngClass","icon_text"],["ngClass","material-symbols-outlined button_icon white"]],template:function(n,e){n&1&&(l(0,Ao,2,0,"div"),l(1,Io,4,0,"div"),a(2,"Footer"),l(3,To,5,0,"button",0),s()),n&2&&(c(e.isLoaded()?-1:0),r(),c(e.userNotebooks()?1:-1),r(2),c(e.userNotebooks()?3:-1))},dependencies:[N,A,io,Y,po],styles:[".notebooks_list[_ngcontent-%COMP%]{list-style:none;color:#fff;margin-block-start:0em;padding-inline-start:0px;padding-left:10px;padding-right:10px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;margin-bottom:2px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child, ul.notebooks_list[_ngcontent-%COMP%]   .notebooks_list_bg[_ngcontent-%COMP%]{padding-top:10px}.notebooks_list_left[_ngcontent-%COMP%]{width:20px;border-radius:6px}.notebooks_list_right[_ngcontent-%COMP%]{display:flex;width:100%;padding-left:10px;align-self:center;font-size:var(--size-4a);color:var(--color-grey-600);flex-direction:column;justify-content:center}.notebooks_list_outer[_ngcontent-%COMP%]{width:100%;height:50px;display:flex}.cardcontent[_ngcontent-%COMP%]{display:flex;padding:13px 16px}.notebooks_list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{padding-top:10px}.notebooks_list_bg[_ngcontent-%COMP%]{position:relative;padding-top:10px}.notebook_default[_ngcontent-%COMP%]{color:var(--notebook-color-default);background:var(--notebook-color-bg-default)}.tab_default[_ngcontent-%COMP%]{background:var(--notebook-color-tab-default)}.tab_red[_ngcontent-%COMP%]{background:var(--notebook-color-tab-red)}.tab_blue[_ngcontent-%COMP%]{background:var(--notebook-color-tab-blue)}.tab_green[_ngcontent-%COMP%]{background:var(--notebook-color-tab-green)}.tab_loading[_ngcontent-%COMP%]{background:var(--notebook-color-tab-loading)}"]})}}return o})();function Eo(o,m){o&1&&(a(0,"div"),k(1,"LoadingScreen"),s())}function Ho(o,m){if(o&1&&(a(0,"div"),k(1,"NotebooksList",1),s()),o&2){let t=u();r(),p("notebooks",t.userNotebooks())}}var ko=(()=>{class o{constructor(t,n){this.authService=t,this.store=n,this.notebooksLoaded=g(!1),this.userNotebooks=g({success:!1,notebooks:[]}),this.onDestroy$=new M,this.updateContext=e=>{this.loading=e.loading,this.token=e.token},this.showNotification=e=>{this.store.dispatch(S.showNotification({notification:{n_status:"error",title:"Error!",message:e}}))},this.loadNotebooks=()=>_(this,null,function*(){if(!this.notebooksLoaded()&&this.token)try{let e=yield so(this.token);if(e.error){this.showNotification(`${e.error}`);return}e.success&&(this.userNotebooks.set(e),this.filterNotebooks())}catch(e){this.showNotification(`${e}`);return}}),this.filterNotebooks=()=>_(this,null,function*(){let e=this.userNotebooks().notebooks,i=this.userNotebooks().error;e&&e.length>0&&(e.map(d=>(d.updatedAt==="No date"&&(d.updatedAt="December 17, 1995 03:24:00"),d)),e.sort((d,b)=>d.updatedAt!==void 0&&b.updatedAt!==void 0?new Date(d.updatedAt)>new Date(b.updatedAt)?1:-1:d.updatedAt!==void 0?1:-1).reverse(),this.userNotebooks.set({success:!0,notebooks:e}),this.notebooksLoaded.set(!0)),i&&this.showNotification(i)})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnInit(){this.authService.authContext$.pipe(x(this.onDestroy$)).subscribe(t=>{this.updateContext(t),this.loadNotebooks()})}static{this.\u0275fac=function(n){return new(n||o)(C(D),C(w))}}static{this.\u0275cmp=f({type:o,selectors:[["Notebooks"]],standalone:!1,decls:3,vars:2,consts:[["ngClass","page_scrollable_header_breadcrumb_footer_list"],[3,"notebooks"]],template:function(n,e){n&1&&(l(0,Eo,2,0,"div"),a(1,"div",0),l(2,Ho,2,1,"div"),s()),n&2&&(c(e.notebooksLoaded()?-1:0),r(2),c(e.notebooksLoaded()&&e.userNotebooks().notebooks?2:-1))},dependencies:[N,A,go],encapsulation:2})}}return o})();var jo=[{path:"",component:ko}],uo=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=y({type:o})}static{this.\u0275inj=O({imports:[I.forChild(jo),I]})}}return o})();var Ht=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=y({type:o})}static{this.\u0275inj=O({imports:[K,uo,ao,to,no,lo]})}}return o})();export{Ht as NotebooksModule};
